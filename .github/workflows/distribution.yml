name: Distribution


on:
  release:
  workflow_dispatch:
    

jobs:
  pip-package:
    runs-on: ubuntu-latest

    steps:
    - name: Get Linux latest release
      uses: robinraju/release-downloader@v1.11
      with:
        repository: ${{ github.repository }}
        latest: true
        extract: true
        fileName: linux.zip

    - name: Get Windows latest release
      uses: robinraju/release-downloader@v1.11
      with:
        repository: ${{ github.repository }}
        latest: true
        extract: true
        fileName: windows.zip

    - name: Create package folder
      run: |
          mkdir package
          mkdir package/dll
          mkdir package/lib
          cp -r ReleaseDLL_Linux/api/python_api package
          mv ReleaseDLL_Linux/lib/*.so package/lib
          mv ReleaseDLL_Windows/dll/*.dll package/dll

    - name: Create zip
      uses: actions/upload-artifact@v4
      with:
        name: pip-package
        path: package
